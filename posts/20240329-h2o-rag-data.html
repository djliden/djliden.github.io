<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Retrieving Data for the H2o RAG Benchmark</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="/org-base.css"/>
<link rel="stylesheet" type="text/css" href="/orgstyle.css"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="icon" href="favicon.ico" type="image/x-icon">
<link rel="me" href="https://emacs.ch/@dliden">
<link rel="alternate" type="application/rss+xml" title="Daniel Liden's Blog" href="/rss.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="/dark-mode.js" defer></script>
<script src="/admonitions.js" defer></script>
</head>
<body>
<div id="preamble" class="status">
<hr class="topnav-rule">
<header class="site-header">
  <a href="/index.html" class="site-header__brand">
    <h2>Daniel Liden</h2>
  </a>
  <nav class="topnav-links" aria-label="Primary">
    <a href="/archive.html">Blog</a>
    <span class="topnav-divider" aria-hidden="true">/</span>
    <a href="/about.html">About Me</a>
    <span class="topnav-divider" aria-hidden="true">/</span>
    <a href="/photos.html">Photos</a>
    <span class="topnav-divider" aria-hidden="true">/</span>
    <a href="/notebooks/">Notebooks</a>
    <span class="topnav-divider" aria-hidden="true">/</span>
    <a href="/notes.html">Notes</a>
    <span class="topnav-divider" aria-hidden="true">/</span>
    <a class="topnav-icon" href="/rss.xml" aria-label="RSS feed">
      <svg class="rss-icon" viewBox="0 0 24 24" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
        <path d="M5 4h1a14 14 0 0 1 14 14v1"/>
        <path d="M5 11h1a7 7 0 0 1 7 7v1"/>
        <circle cx="6" cy="18" r="2"/>
      </svg>
    </a>
    <span class="topnav-divider" aria-hidden="true">/</span>
    <button id="theme-toggle" class="nav-theme-toggle topnav-icon" type="button" aria-label="Switch to dark mode" aria-pressed="false">
      <svg class="theme-icon" viewBox="0 0 24 24" aria-hidden="true" fill="currentColor">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79Z"/>
      </svg>
    </button>
  </nav>
</header>
<hr class="topnav-rule">
</div>
<div id="content" class="content">
<header>
<h1 class="title">Retrieving Data for the H2o RAG Benchmark</h1>
</header><div class="preview" id="org0b0352c">
<p>
I was looking for a good dataset to use for comparing different models in a RAG application when I found <a href="https://www.reddit.com/r/LocalLLaMA/comments/1bpo5uo/rag_benchmark_of_databricksdbrx/">this post</a> on Reddit. It compares a bunch of models on a collection of questions over a set of documents provided by <a href="https://h2o.ai">H2O.ai</a>.
</p>

<p>
I wasn't super interested in the benchmark, but the files (mostly pdfs, one mp3, jpg, other file types) interested me for use in my own testing. This short post shows how to get them using the scripts provided by h2o.ai.
</p>

</div>

<p>
To get started with the H2O RAG benchmark, first clone the <code>enterprise-h2ogpte</code> repo and navigate to the <code>rag_benchmark</code> directory:
</p>

<div class="org-src-container">
<pre class="src src-sh">git clone https://github.com/h2oai/enterprise-h2ogpte.git
<span class="org-builtin">cd</span> enterprise-h2ogpte/rag_benchmark
</pre>
</div>

<p>
Next, perhaps in a notebook, instantiate each of the documents.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> datasets <span class="org-keyword">import</span> CachedFile

<span class="org-variable-name">femsa</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"Femsa"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/Coca-Cola-FEMSA-Results-1Q23-vf-2.pdf"</span>,
)
<span class="org-variable-name">wells_fargo</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"WellsFargo"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/wellsfargo-2022-annual-report.pdf"</span>,
)
<span class="org-variable-name">citi_report</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"CitiAnnual"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/citi-2022-annual-report.pdf"</span>,
)
<span class="org-variable-name">kaiser</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"Kaiser"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/kp-annual-report-en-2019.pdf"</span>,
)
<span class="org-variable-name">cba</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"CBA-Spreads"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/2023-Annual-Report-Spreads.pdf"</span>,
)
<span class="org-variable-name">cba_fullpage</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"CBA-Annual"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/CBA.2023.Annual.Report.pdf"</span>,
)
<span class="org-variable-name">cba_wheel</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"CBA-Wheel"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/CBA-1H23-Results-Presentation_wheel.pdf"</span>,
)
<span class="org-variable-name">nyl_all</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"NYL_All"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/2022-nyl-investment-report.pdf"</span>,
)
<span class="org-variable-name">bradesco</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"Bradesco"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/bradesco-2022-integrated-report.pdf"</span>,
)
<span class="org-variable-name">tabasco</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"Tabasco"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/Tabasco_Ingredients_Products_Guide.pdf"</span>,
)
<span class="org-variable-name">citi_report_pg6</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"Citi6"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/citi-2022-annual-report-page6.pdf"</span>,
)
<span class="org-variable-name">citi_report_pg1_2</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"Citi1_2"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/citi-2022-annual-report-pages1-2.pdf"</span>,
)
<span class="org-variable-name">nyl_report_pg5_15</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"NYL5_15"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/2022-nyl-investment-report-pages-5-and-15.pdf"</span>,
)
<span class="org-variable-name">aluminum_int</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"AluminumInt"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/Aluminum.Intelligence.Report.November.2022.pdf"</span>,
)
<span class="org-variable-name">albumentations_markdown</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"AlbumentationsREADME"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/albumentations-README.md"</span>,
)
<span class="org-variable-name">best_buy</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"BestBuy"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/Best-Buy-Investor-Event-March-2022.pdf"</span>,
)

<span class="org-variable-name">example_rst</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"ExampleRST"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/example-rst2.rst"</span>,
)

<span class="org-variable-name">audio_label_genie</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"AudioLabelGenie"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/label-genie-intro-youtube.mp3"</span>,
)

<span class="org-variable-name">fast_food</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"FastFood"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/fastfood.jpg"</span>,
)

<span class="org-variable-name">sanepar_pg4</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"Sanepar_4"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/Demonstracoes-Financeiras-Anuaanepar-2022-12-31-gmdgFjGq-page4.pdf"</span>,
)

<span class="org-variable-name">dell_scanned_pr</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"dell_scanned_pr"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/Q2 FY24 Financial Results Press Release.pdf"</span>,
)

<span class="org-variable-name">jpeg_xr_image</span> <span class="org-operator">=</span> CachedFile(
    <span class="org-string">"JPEG-XR"</span>,
    <span class="org-string">"https://enterprise-h2ogpt-public-data.s3.amazonaws.com/gilgamesh_tablet_1.jxr"</span>,
)
</pre>
</div>


<p>
Next, use the <code>get()</code> method from each <code>CachedFile</code> instance to download its file.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">instances</span> <span class="org-operator">=</span> [
    femsa,
    wells_fargo,
    citi_report,
    kaiser,
    cba,
    cba_fullpage,
    cba_wheel,
    nyl_all,
    bradesco,
    tabasco,
    citi_report_pg6,
    citi_report_pg1_2,
    nyl_report_pg5_15,
    aluminum_int,
    albumentations_markdown,
    best_buy,
    example_rst,
    audio_label_genie,
    fast_food,
    sanepar_pg4,
    dell_scanned_pr,
    jpeg_xr_image,
]

<span class="org-keyword">for</span> instance <span class="org-keyword">in</span> instances:
    <span class="org-keyword">try</span>:
        <span class="org-variable-name">result</span> <span class="org-operator">=</span> instance.get()
        <span class="org-builtin">print</span>(<span class="org-string">"---"</span>)
    <span class="org-keyword">except</span> <span class="org-type">Exception</span> <span class="org-keyword">as</span> e:
        <span class="org-builtin">print</span>(f<span class="org-string">"Error occurred for instance </span>{instance}<span class="org-string">: </span>{<span class="org-builtin">str</span>(e)}<span class="org-string">"</span>)
        <span class="org-builtin">print</span>(<span class="org-string">"---"</span>)
</pre>
</div>

<p>
Run the notebook cells to fetch the files. They will be stored in the <code>/data/cached</code> directory under <code>rag_benchmark</code>. You can now use them for whatever you want.
</p>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2024-03-29 Fri 00:00</p>
<p class="creator"><a href="https://www.gnu.org/software/emacs/">Emacs</a> 29.3 (<a href="https://orgmode.org">Org</a> mode 9.6.15)</p>
</div>
</body>
</html>
